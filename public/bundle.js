(()=>{"use strict";const t=document.querySelector.bind(document),o=document.querySelectorAll.bind(document),n=(t,o,n)=>null==t?void 0:t.addEventListener(o,n),e=(t,o)=>{t&&(t.innerHTML=o)},a=(t,o)=>{if(t)for(const n in o)t.style[n]=o[n]},r=(t,o)=>{if(t)for(let n of o.split(" "))return t.classList.contains(n)},l=(t,o,n="add")=>{t&&o.split(" ").forEach((o=>{t.classList[n](o)}))},s=t=>t.getBoundingClientRect(),i=(t,o)=>Math.floor(Math.random()*(o-t+1))+t,c="container",d=["#de8f6f","#3c7cab"],h=({id:t,left:o,top:n,rotation:e,scale:a})=>`<div\n  id="${t}"\n  class="arrow"\n  style="transform:rotate(${e}deg);left:${o}px;top:${n}px;"\n>\n  <svg viewBox="0 0 85 470" style="transform:scaleY(${a});">\n    <polygon\n      fill="#E6E9ED"\n      points="85.32601928710938,127.98799896240234 51.201019287109375,149.33100128173828 33.516021728515625,149.33100128173828 0,127.98799896240234 0,21.334999084472656 85.32601928710938,21.334999084472656 "\n    />\n    <path\n      fill="#FFCE54"\n      d="m50.20101,3.117c-4.155,-4.156 -10.921,-4.156 -15.077,0c-2.093,2.094 -3.124,4.812 -3.124,7.547l0,0l0,394.283l21.326,0l0,-394.252c0.016,-2.734 -1.031,-5.484 -3.125,-7.578z"\n    />\n    <path\n      fill="#ED5564"\n      d="m55.37301,390.666c-4.484,0 -8.812,1.031 -12.718,2.984c-3.891,-1.953 -8.219,-2.984 -12.702,-2.984c-15.703,0 -28.469,12.766 -28.469,28.469c0,25.717 32.141,45.217 35.812,47.357l5.375,3.125l5.375,-3.125c3.655,-2.141 35.796,-21.641 35.796,-47.357c0,-15.688 -12.766,-28.469 -28.469,-28.469z"\n    />\n  </svg>\n</div>`,p=({id:t,fill:o,left:n,top:e,rotation:a,scale:r})=>`<div\n  id="${t}"\n  class="bow"\n  style="transform:rotate(${a}deg);left:${n}px;top:${e}px"\n>\n  <svg viewBox="0 0 190 491" style="transform:scaleX(${r});">\n    <rect x="12" fill="black" width="21" height="500"/>\n    <path\n      fill="${o}"\n      d="m170.75487,205.321c0,0 20.5,-29.858 19.406,-52.482c-4,-83.169 -107.668,-88.497 -159.557,-152.839l-30.515,0c-4.156,64.467 138.823,93.419 141.964,146.448c1.438,24.421 -13.984,53.857 -13.984,53.857l0,90.028c0,0 15.421,29.437 13.984,53.857c-3.141,53.029 -146.12,81.982 -141.964,146.449l30.515,0c51.889,-64.342 155.557,-69.67 159.557,-152.84c1.094,-22.623 -19.406,-52.482 -19.406,-52.482l0,-79.996z"\n    />\n  </svg>\n</div>`,f=({index:t,type:o})=>`<div class="case ${o}">\n  ${h({id:`ac-${t}-1`,left:5,top:-50,rotation:-10,scale:1})}\n  ${h({id:`ac-${t}-2`,left:17,top:-50,rotation:0,scale:1})}\n  ${h({id:`ac-${t}-3`,left:29,top:-50,rotation:10,scale:1})}\n  </div>`,v=[{w:140,h:245,p:[[54,0],[36,35],[71,35],[18,70],[53,70],[88,70],[0,105],[35,105],[70,105],[105,105],[18,140],[53,140],[88,140],[36,175],[71,175],[54,210]]},{w:105,h:105,p:[[35,0],[35,35],[35,70],[0,35],[70,35]]},{w:175,h:175,a:!0,p:[[155,68],[145,108],[117,140],[78,154],[36,149],[2,126],[-17,88],[-17,47],[2,9],[36,-14],[78,-19],[117,-5],[145,27]]},{w:175,h:175,p:[[70,0],[35,35],[105,35],[0,70],[70,70],[140,70],[35,105],[105,105],[70,140]]},{w:140,h:140,a:!0,p:[[0,0],[35,0],[70,0],[105,0],[0,35],[105,35],[0,70],[105,70],[0,105],[35,105],[70,105],[105,105]]},{w:35,h:105,p:[[0,0],[0,35],[0,70]]},{w:175,h:175,a:!0,p:[[0,70],[35,70],[70,70],[105,70],[140,70],[70,0],[70,35],[70,105],[70,140]]},{w:105,h:105,p:[[35,35],[0,35],[70,35],[35,0],[35,70]]}],$=(o=0)=>{const{w:n,h:e,p:a,a:r=!1}=v[o],l=r||1===i(0,1);let s="";if(l){const t=i(0,1);s=`--s:${i(2,5)}s;--i:${t?"0":"359"}deg;--f:${t?"359":"0"}deg;`}return t("html").style.cssText=s,`<div class="targets${l?" a":""}" style="width:${n}px;height:${e}px;">\n  ${a.map((([t,o],n)=>((t="",o=0,n=0)=>`<div class="target" id=${t} style="left:${o}px;top:${n}px"></div>`)(`t-${n}`,t,o))).join("")}\n  </div>`};let w,u=0,g=!1;const b="hide";let x=!1;const y=[{animate:!1,angle:0,point:{x:0,y:0},score:0,arrows:0,hasArrow:!0},{animate:!1,angle:0,point:{x:0,y:0},score:0,arrows:0,hasArrow:!0}],m=[{bow:{fill:d[0],left:176,top:542,rotation:270,scale:1},arrow:{left:195,top:572,rotation:0,scale:-1}},{bow:{fill:d[1],left:176,top:40,rotation:270,scale:-1},arrow:{left:195,top:75,rotation:0,scale:1}}],M=(t,o)=>{const n=s(o),e=s(t);return{top:Math.round(n.top-e.top),left:Math.round(n.left-e.left)}},E=(t=0)=>{let o=t%360;return o<0&&(o+=360),Math.round(Math.abs(o))},I=(t,o)=>180*Math.atan2(t.y-o.y,t.x-o.x)/Math.PI,A=o=>{const{left:n,top:e}=s(t("#control"));let a=0,r=0;o instanceof MouseEvent?(a=o.clientX,r=o.clientY):o instanceof TouchEvent&&(a=o.touches[0].clientX,r=o.touches[0].clientY);return{x:Math.round(a-n),y:Math.round(r-e)}},j=o=>{const n=t("#bow-1"),{left:e,top:r}=M(t("#control"),n),{width:l}=s(n),i={x:Math.round(e+l/2),y:r},c=I(i,o),d=E(c);if(d>=180&&d<=360){a(n,{transform:`rotate(${d}deg)`});const o=d-270;y[0].angle=o,a(t("#arrow-1"),{transform:`rotate(${o}deg)`})}},L=()=>e(t(".score"),`<span>${y[0].score}</span> - <span>${y[1].score}</span>`),k=()=>[...o(".target")].filter((t=>!r(t,b))),D=(t,o)=>t.x>=o.start.x&&t.y>=o.start.y&&t.x<=o.end.x&&t.y<=o.end.y,R=(o,n)=>{const e=t(`#arrow-${o}`),{angle:a}=y[o-1],{x:r,y:l}=((t,o,n)=>{const e=s(o),a=e.width,r=e.height,l=t*(1===n?1:-1)*Math.PI/180;return{x:e.left+a/2+r/2*Math.sin(l),y:e.top+(2===n?r-20:0)+r/2-r/2*Math.cos(l)}})(a,e,o),i=s(n),c={start:{x:Math.round(i.x),y:Math.round(i.y)},end:{x:Math.round(i.x+i.width),y:Math.round(i.y+i.height)}};return D({x:r-3,y:l},c)||D({x:r,y:l},c)||D({x:r+3,y:l},c)},B=(o=1)=>{const n=t(`#arrow-${o}`),{angle:s,point:i}=y[o-1],c=(s-90)*(Math.PI/180),d=i.x+15*Math.cos(c)*(1===o?1:-1),h=i.y+15*Math.sin(c)*(1===o?1:-1);if(y[o-1].point={x:d,y:h},a(n,{left:`${d}px`,top:`${h}px`}),p=d,(f=h)<-100||p<-50||f>832||p>462){y[o-1].animate=!1,clearInterval(y[o-1].interval);const r=y[o-1].arrows>0;if(y[o-1].hasArrow=r,r){const{left:e,top:r}=m[o-1].arrow;a(n,{left:`${e}px`,top:`${r}px`}),l(t(`#ac-${o}-${y[o-1].arrows}`),b,"add"),y[o-1].arrows--,2===o&&C()}else a(t(`#bow-${o}`),{transform:`rotate(${m[o-1].bow.rotation}deg)`});(()=>{const o=y.findIndex((t=>t.score>=70));if(o>=0){X(),x=!0;const n=t(".win-ui"),a=0===o?"r":"b";e(n,`<span>${0===o?"RED":"BLUE"} WIN</span>`),l(n,b,"remove"),l(n,a,"add")}else{const t=k(),o=0!==y.filter((t=>t.hasArrow)).length;(0===t.length||!o)&&(X(),H())}})()}else(t=>{const o=k();for(const n of o){const o=n;R(t,o)&&!r(o,b)&&(l(o,b,"add"),y[t-1].score++,L())}})(o);var p,f},S=(t=1)=>{const{left:o,top:n}=m[t-1].arrow;y[t-1].point={x:o,y:n},y[t-1].animate=!0,y[t-1].interval=setInterval((()=>B(t)),1)},T=t=>{x||g||y[0].animate||!y[0].hasArrow||(j(A(t)),g=!0)},Y=()=>{x||!g||y[0].animate||(S(),g=!1)},z=t=>{x||!g||y[0].animate||j(A(t))},X=()=>{w&&clearInterval(w);for(let t=0;t<y.length;t++)y[t].interval&&clearInterval(y[t].interval)},C=()=>{let o=k();const n=[18,10,2][u-1];if(x||0===o.length)return;let e=i(0,o.length-1),l=o[e];const s={x:m[1].bow.left,y:m[1].bow.top};let c=0;w=setInterval((()=>{x&&clearInterval(w);const{left:d,top:h}=M(t(".game"),l),p=E(I(s,{x:d,y:h}));a(t("#bow-2"),{transform:`rotate(${p}deg)`});const f=p-270;if(y[1].angle=f,a(t("#arrow-2"),{transform:`rotate(${f}deg)`}),c++,c%n==0){let t=!0;r(l,b)&&(o=k(),0!==o.length&&(e=i(0,o.length-1),l=o[e],t=!1)),t&&(clearInterval(w),S(2))}}),100)},H=()=>{const o=i(0,v.length-1);e(t("#r-target"),$(o)),m.forEach((({arrow:o,bow:n},e)=>{a(t(`#bow-${e+1}`),{transform:`rotate(${n.rotation}deg)`}),a(t(`#arrow-${e+1}`),{left:`${o.left}px`,top:`${o.top}px`,transform:`rotate(${o.rotation}deg)`,display:"block"})}));for(let o=0;o<y.length;o++){y[o].animate=!1,y[o].arrows=2,y[o].hasArrow=!0,y[o].interval&&clearInterval(y[o].interval);for(let n=1;n<=3;n++)l(t(`#ac-${o+1}-${n}`),b,3===n?"add":"remove")}C()},P=({color:t,score:o})=>`<div class="pe"><svg viewBox="0 0 24 24">\n    <path fill=${t} d="M20.822 18.096c-3.439-.794-6.64-1.49-5.09-4.418 4.72-8.912 1.251-13.678-3.732-13.678-5.082 0-8.464 4.949-3.732 13.678 1.597 2.945-1.725 3.641-5.09 4.418-3.073.71-3.188 2.236-3.178 4.904l.004 1h23.99l.004-.969c.012-2.688-.092-4.222-3.176-4.935z"/>\n  </svg>\n  <div class="pe-sco">${o}</div>\n  </div>`,q={Game:({dificulty:o=1})=>{const a=`<div class="game wh jc">\n      <div class="lock-ui wh jc"></div>\n      <div class="win-ui hide wh jc"></div>\n      ${m.map(((t,o)=>`${p(Object.assign({id:`bow-${o+1}`},t.bow))}\n          ${h(Object.assign({id:`arrow-${o+1}`},t.arrow))}\n          ${f({index:o+1,type:0===o?"bottom":"top"})}\n        `)).join("")}\n      <div class="score jc"></div>\n      <button id="exit">EXIT</button>\n      <div id="r-target"></div>\n      <div id="control"></div>\n  </div>`;e(t(`#${c}`),a),(o=>{u=o,[["mousedown",T],["mouseup",Y],["mousemove",z],["touchstart",T],["touchend",Y],["touchmove",z],["mouseleave",Y]].forEach((o=>n(t("#control"),o[0],o[1]))),n(t("#exit"),"click",(()=>{X(),F("Lobby")})),x=!1;for(let t=0;t<y.length;t++)y[t].score=0;L();let a=3;const r=setInterval((()=>{e(t(".lock-ui"),String(a)),a--,a<0&&(l(t(".lock-ui"),b,"add"),clearInterval(r),H())}),1e3)})(o)},Lobby:()=>{const a=`<div class="lobby wh">\n  <h1>ARCHERY MASTER</h1>\n  <div class="lobby-btn jc">\n      <p>\n        Load your bow and hit 70 targets before your opponent!\n      </p>\n      <div class="jc">\n        <button>EASY</button>\n        <button>MEDIUM</button>\n        <button>HARD</button>\n      </div>\n    </div>\n    <div class="lobby-pe">\n      ${P({color:d[0],score:0})}\n      ${P({color:d[1],score:0})}\n    </div>\n  </div>`;e(t(`#${c}`),a),[...o(".lobby button")].forEach(((t,o)=>{n(t,"click",(()=>{F("Game",{dificulty:o+1})}))}))}},F=(t="Lobby",o={})=>{q[t](o)};e(t("#root"),`<div\n    id="${c}"\n    style="overflow: hidden;width:412px;height:732px"\n  ></div>`),n(document,"contextmenu",(t=>t.preventDefault())),F("Lobby")})();